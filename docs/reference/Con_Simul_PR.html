<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate Positive Rates for Contingency Table — Con_Simul_PR • safuncs</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Positive Rates for Contingency Table — Con_Simul_PR"><meta property="og:description" content="Computes statistical power and optionally false positive rates for tests applied to contingency tables based on simulations. Specify the simulation process using Con_Simul(), which serves as input. Positive rates are computed for the Chi-square test and optionally for Fisher's exact test and the Wald test applied to an ordinal regression model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">safuncs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sean4andrew/safuncs/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate Positive Rates for Contingency Table</h1>
    <small class="dont-index">Source: <a href="https://github.com/sean4andrew/safuncs/blob/HEAD/R/safuncs.R" class="external-link"><code>R/safuncs.R</code></a></small>
    <div class="hidden name"><code>Con_Simul_PR.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes statistical power and optionally false positive rates for tests applied to contingency tables based on simulations. Specify the simulation process using <code><a href="Con_Simul.html">Con_Simul()</a></code>, which serves as input. Positive rates are computed for the Chi-square test and optionally for Fisher's exact test and the Wald test applied to an ordinal regression model.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Con_Simul_PR</span><span class="op">(</span></span>
<span>  Con_Simul_Object <span class="op">=</span> <span class="fu"><a href="Con_Simul.html">Con_Simul</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  add_fisher_exact <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add_ord <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sample_sizes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_sim <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  FPR <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-con-simul-object">Con_Simul_Object<a class="anchor" aria-label="anchor" href="#arg-con-simul-object"></a></dt>
<dd><p>Output from <code><a href="Con_Simul.html">Con_Simul()</a></code> with the argument <code>verbose</code> set to TRUE.</p></dd>


<dt id="arg-add-fisher-exact">add_fisher_exact<a class="anchor" aria-label="anchor" href="#arg-add-fisher-exact"></a></dt>
<dd><p>Whether to compute positive rates for Fisher's Exact test. May add &gt;1 min of calculation time. Defaults to FALSE.</p></dd>


<dt id="arg-add-ord">add_ord<a class="anchor" aria-label="anchor" href="#arg-add-ord"></a></dt>
<dd><p>Whether to compute positive rates for Wald test on a fitted ordinal regression model. May add &gt;1 min of calculation time. Defaults to FALSE.</p></dd>


<dt id="arg-sample-sizes">sample_sizes<a class="anchor" aria-label="anchor" href="#arg-sample-sizes"></a></dt>
<dd><p>A vector of sample sizes over which false positive rates are to be calculated. A sample size is defined as the total number of counts in a contingency table. Defaults to total count received by <code>Con_Simul_Object</code>.</p></dd>


<dt id="arg-n-sim">n_sim<a class="anchor" aria-label="anchor" href="#arg-n-sim"></a></dt>
<dd><p>Number of contingency tables simulated for each positive rate calculation. Defaults to 1000.</p></dd>


<dt id="arg-fpr">FPR<a class="anchor" aria-label="anchor" href="#arg-fpr"></a></dt>
<dd><p>Whether to calculate false positive rate in addition to power. Defaults to TRUE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns a list containing:</p><table class="table table"><tr><td><code>pos_rate</code></td><td></td><td>A dataframe containing positive rates of various tests at specified sample sizes</td></tr><tr><td><code>eff_mat</code></td><td></td><td>The probability matrix used to calculate power</td></tr><tr><td><code>null_mat</code></td><td></td><td>The probability matrix used to calculate false positive rate</td></tr><tr><td><code>plot</code></td><td></td><td>A plot of positive rates of various tests at specified sample sizes</td></tr></table></div>
    <div id="details">
    <h2>Details</h2>
    <p>Power is defined as the percentage of tests yielding positive results (p-value &lt; 0.05) on a set of contingency tables simulated based on the data-generating process and probability matrix specified in <code><a href="Con_Simul.html">Con_Simul()</a></code>. The specified probability matrix should represent the parameters of the population where there is a desire to detect a significant effect in the sample. The simulated contingency tables then reflect the sample outcomes of the specified population parameter.</p>
<p>False Positive Rate is defined as the percentage of tests yielding positive results (p-value &lt; 0.05) on contingency tables simulated based on a probability matrix without treatment effect. The odd ratios between lesion scores for all treatment groups are assumed to be the same as that for control (first row in the probability matrix).</p>
<p>P-values for the Chi-square test are computed using <code><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">stats::chisq.test()</a></code> with default parameters. P-values for Fisher's exact test are computed using <code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">stats::fisher.test()</a></code> with <code>simulate.p.value</code> set to TRUE, alongside default parameters. P-values for ordinal regression are computed from <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">stats::anova()</a></code> applied to the output of <code><a href="https://rdrr.io/pkg/ordinal/man/clm.html" class="external-link">ordinal::clm()</a></code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Below I show how we can perform a simple power calculation using this tool.</span></span></span>
<span class="r-in"><span><span class="co">## Suppose I want to calculate power for Treatment B which halves the lesions in category 2 and 3.</span></span></span>
<span class="r-in"><span><span class="co">## I then specify the following probability matrix and feed it into Con_Simul():</span></span></span>
<span class="r-in"><span><span class="va">probs_mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">12</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim_tab</span> <span class="op">=</span> <span class="fu"><a href="Con_Simul.html">Con_Simul</a></span><span class="op">(</span><span class="va">probs_mat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Next, I feed the output into Con_Simul_PR():</span></span></span>
<span class="r-in"><span><span class="fu">Con_Simul_PR</span><span class="op">(</span><span class="va">sim_tab</span>, sample_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pos_rate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Total_Count Percent_of_Significant_Results Statistical_Test Class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           50                           56.8        Chisquare Power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          100                           87.5        Chisquare Power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          150                           95.7        Chisquare Power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10          50                            4.1        Chisquare   FPR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         100                            5.7        Chisquare   FPR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         150                            4.8        Chisquare   FPR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eff_mat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.1666667 0.16666667 0.16666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.3333333 0.08333333 0.08333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $null_mat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]      [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.1666667 0.1666667 0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.1666667 0.1666667 0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $plot</span>
<span class="r-plt img"><img src="Con_Simul_PR-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## Results: Power is ~55, 86, and 97% for the Chi-square test using total counts of 50, 100, and 150, respectively.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The same power for Chi-square test can be calculated using Cohen's omega (w) method which is faster but has its own limitations;</span></span></span>
<span class="r-in"><span><span class="co">## e.g. assumes one data generating process for the contingency table (the no fixed marginals).</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/heliosdrm/pwr" class="external-link">pwr</a></span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>package 'pwr' was built under R version 4.4.1</span>
<span class="r-in"><span><span class="fu">pwr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.chisq.test.html" class="external-link">pwr.chisq.test</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pwr/man/ES.w2.html" class="external-link">ES.w2</a></span><span class="op">(</span><span class="va">probs_mat</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">2</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span>, N <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Chi squared power calculation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               w = 0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               N = 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              df = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       sig.level = 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           power = 0.8563144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOTE: N is the number of observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## Results: Power is 85.6% for the Chi-square test at the total count of 100.</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sean Andrew.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>


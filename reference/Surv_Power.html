<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculates Power for Survival Experiments — Surv_Power • safuncs</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculates Power for Survival Experiments — Surv_Power"><meta name="description" content='Calculates the power of global and/or pairwise hypothesis tests for survival studies with support over a range of experimental designs. This versatility is enabled by the simulation-based approach of the power calculation, using the modular Surv_Simul() to simulate survival data of various experimental designs. Power calculations can be made to account for inter-tank variation using a mixed cox proportional hazards model (set argument model = "coxph_glmm"). Additionally, power calculations can account for the multiplicity of pairwise comparisons using pairwise_corr. Users can compare power across different experimental designs by specifying each as a list element in Surv_Simul(). A brief tutorial is written in Examples (unfinished) to guide the user on how to use Surv_Power() to calculate power for various cases.'><meta property="og:description" content='Calculates the power of global and/or pairwise hypothesis tests for survival studies with support over a range of experimental designs. This versatility is enabled by the simulation-based approach of the power calculation, using the modular Surv_Simul() to simulate survival data of various experimental designs. Power calculations can be made to account for inter-tank variation using a mixed cox proportional hazards model (set argument model = "coxph_glmm"). Additionally, power calculations can account for the multiplicity of pairwise comparisons using pairwise_corr. Users can compare power across different experimental designs by specifying each as a list element in Surv_Simul(). A brief tutorial is written in Examples (unfinished) to guide the user on how to use Surv_Power() to calculate power for various cases.'><meta property="og:image" content="https://sean4andrew.github.io/safuncs/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">safuncs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/safuncs.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sean4andrew/safuncs/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculates Power for Survival Experiments</h1>
      <small class="dont-index">Source: <a href="https://github.com/sean4andrew/safuncs/blob/master/R/safuncs.R" class="external-link"><code>R/safuncs.R</code></a></small>
      <div class="d-none name"><code>Surv_Power.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the power of global and/or pairwise hypothesis tests for survival studies with support over a range of experimental designs. This versatility is enabled by the simulation-based approach of the power calculation, using the modular <code><a href="Surv_Simul.html">Surv_Simul()</a></code> to simulate survival data of various experimental designs. Power calculations can be made to account for inter-tank variation using a mixed cox proportional hazards model (set argument <code>model = "coxph_glmm"</code>). Additionally, power calculations can account for the multiplicity of pairwise comparisons using <code>pairwise_corr</code>. Users can compare power across different experimental designs by specifying each as a list element in <code><a href="Surv_Simul.html">Surv_Simul()</a></code>. A brief tutorial is written in <b>Examples</b> (unfinished) to guide the user on how to use <code>Surv_Power()</code> to calculate power for various cases.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Surv_Power</span><span class="op">(</span></span>
<span>  simul_db <span class="op">=</span> <span class="va">simul_db_ex</span>,</span>
<span>  global_test <span class="op">=</span> <span class="st">"logrank"</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pairwise_test <span class="op">=</span> <span class="st">"logrank"</span>,</span>
<span>  pairwise_corr <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>  prog_show <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_out <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_lines <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"List Element #"</span>,</span>
<span>  xnames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_save <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-simul-db">simul_db<a class="anchor" aria-label="anchor" href="#arg-simul-db"></a></dt>
<dd><p>An output from <code><a href="Surv_Simul.html">Surv_Simul()</a></code> which includes the survival dataframe simulated with the desired experimental design parameters.</p></dd>


<dt id="arg-global-test">global_test<a class="anchor" aria-label="anchor" href="#arg-global-test"></a></dt>
<dd><p>A character vector representing the method(s) to use for global hypothesis testing of significance of treatment. Methods available are: "logrank", "wald", "score", "LRT". "logrank" represents the global logrank test of significance. The latter three methods are standard global hypothesis testing methods for models. They are only available when the argument <code>model</code> is specified (i.e. not NULL). "wald" represents the Wald Chisquare Test which assesses whether model parameters (log(hazard ratios)) jointly are significantly different from 0 (i.e. HRs ≠ 1). Wald test can be done for various cox-proportional hazard models that could be relevant to our studies (glm, glmm, and gee). Due to its broad applicability, while also producing practically the same p-value most of the time compared to the other model tests, "wald" is the recommended option of the three. "score" represents the Lagrange multiplier or Score test. 'LRT' represents the likelihood ratio test. Defaults to "logrank" for now due to its ubiquity of use.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A character vector representing the model(s) to fit for hypothesis testing. Models available are: "coxph_glm" and "coxph_glmm". "coxph_glm" represents the standard cox proportional hazard model fitted using <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">survival::coxph()</a></code> with Trt.ID as a fixed factor. "coxph_glmm" represents the mixed cox proportional hazard model fitted using <code><a href="https://rdrr.io/pkg/coxme/man/coxme.html" class="external-link">coxme::coxme()</a></code> with Trt.ID as a fixed factor and Tank.ID as a random factor to account for inter-tank variation. Defaults to NULL where no model is fitted for hypothesis testing.</p></dd>


<dt id="arg-pairwise-test">pairwise_test<a class="anchor" aria-label="anchor" href="#arg-pairwise-test"></a></dt>
<dd><p>A character vector representing the method(s) used for pairwise hypothesis tests. Use "logrank" to calculate power for logrank tests comparing different treatments. Use "EMM" to calculate power using Estimated Marginal Means based on model estimates (from 'coxph_glm' and/or 'coxph_glmm'). Defaults to "logrank".</p></dd>


<dt id="arg-pairwise-corr">pairwise_corr<a class="anchor" aria-label="anchor" href="#arg-pairwise-corr"></a></dt>
<dd><p>A character vector representing the method(s) used to adjust p-values for multiplicity of pairwise comparisons. For clarification, this affects the power of the pairwise comparisons. Methods available are: "tukey", "holm", "hochberg", "hommel", "bonferroni", "BH", "BY", and "none". Under <b>Details</b> (yet to be finished), I discuss the common categories of adjustment methods and provided a recommendation for "BH". Defaults to "none" for now.</p></dd>


<dt id="arg-prog-show">prog_show<a class="anchor" aria-label="anchor" href="#arg-prog-show"></a></dt>
<dd><p>Whether to display the progress of <code>Surv_Power()</code> by printing the number of sample sets with p-values calculated. Defaults to TRUE.</p></dd>


<dt id="arg-plot-out">plot_out<a class="anchor" aria-label="anchor" href="#arg-plot-out"></a></dt>
<dd><p>Whether to output plots illustrating the power of global and/or pairwise hypothesis tests. Defaults to TRUE.</p></dd>


<dt id="arg-plot-lines">plot_lines<a class="anchor" aria-label="anchor" href="#arg-plot-lines"></a></dt>
<dd><p>Whether to plot lines connecting points of the same hypothesis test in the plot output. Defaults to TRUE.</p></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>A string representing the x-axis title. Defaults to "List Element #".</p></dd>


<dt id="arg-xnames">xnames<a class="anchor" aria-label="anchor" href="#arg-xnames"></a></dt>
<dd><p>A character vector of names for x-axis labels. Defaults to NULL where names are the list element numbers from <code><a href="Surv_Simul.html">Surv_Simul()</a></code>.</p></dd>


<dt id="arg-plot-save">plot_save<a class="anchor" aria-label="anchor" href="#arg-plot-save"></a></dt>
<dd><p>Whether to save plots as a .tiff in the working directory. Defaults to TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Outputs a list containing any of the following four items depending on input arguments:</p>
<ul><li><p>When <code>global_test ≠ NULL</code>, outputs a dataframe named <code>power_glob_db</code> containing power values calculated for global hypothesis tests. The dataframe consists of six columns:</p><table class="table table"><tr><td><code>model</code></td><td></td><td>The type of model being evaluated in power calculations</td></tr><tr><td><code>global_test</code></td><td></td><td>The global hypothesis test being evaluated</td></tr><tr><td><code>power</code></td><td></td><td>The percentage of p-values below 0.05, i.e. power</td></tr><tr><td><code>power_se</code></td><td></td><td>Standard error for percentages</td></tr><tr><td><code>sample_sets_n</code></td><td></td><td>Number of sample sets used in calculating power</td></tr><tr><td><code>list_element_num</code></td><td></td><td>The list element number associated with the power value calculated</td></tr></table></li>
<li><p>When <code>global_test ≠ NULL</code> and <code>plot_out = TRUE</code>, a plot showing power values for global hypothesis test. Plot corresponds to <code>power_glob_db</code>.</p></li>
<li><p>When <code>pairwise_test ≠ NULL</code>, outputs a dataframe named <code>power_pair_db</code> containing power values for pairwise hypothesis tests. The dataframe consists of eight columns:</p><table class="table table"><tr><td><code>pair</code></td><td></td><td>The treatment groups to be compared</td></tr><tr><td><code>model</code></td><td></td><td>The type of model being evaluated in power calculations</td></tr><tr><td><code>pairwise_test</code></td><td></td><td>The type of pairwise_test being evaluated</td></tr><tr><td><code>pairwise_corr</code></td><td></td><td>The method of p-value correction/adjustments for paiwrise comparisons</td></tr><tr><td><code>power</code></td><td></td><td>The percentage of p-values below 0.05, i.e. power</td></tr><tr><td><code>power_se</code></td><td></td><td>Standard error for percentages</td></tr><tr><td><code>sample_sets_n</code></td><td></td><td>Number of sample sets used in calculating power</td></tr><tr><td><code>list_element_num</code></td><td></td><td>The list element number associated with the power value calculated</td></tr></table></li>
<li><p>When <code>pairwise_test ≠ NULL</code> and <code>plot_out = TRUE</code>, a plot showing power values across list elements. Plot corresponds to <code>power_pair_db</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://sean4andrew.github.io/safuncs/reference/Surv_Power.html">Link</a> for web documentation.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Below is a tutorial (under construction) on how to calculate power using</span></span></span>
<span class="r-in"><span><span class="co"># Surv_Power(). First, we'll have to simulate the future survival dataset using</span></span></span>
<span class="r-in"><span><span class="co"># Surv_Simul().</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># First, we'll load up a past data to use as a reference for the simulations.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">haz_db_ex</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">haz_db_ex</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">haz_db_ex</span> <span class="op">=</span> <span class="va">haz_db_ex</span><span class="op">[</span><span class="va">haz_db_ex</span><span class="op">$</span><span class="va">Trt.ID</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">]</span> <span class="co"># filter for control fish</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in haz_db_ex$Trt.ID:</span> $ operator is invalid for atomic vectors</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">haz_db_ex</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "haz_db_ex"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># As may be clear from the above, we are using the past data's hazard curve properties.</span></span></span>
<span class="r-in"><span><span class="co"># NOTE: Whether the shape of the hazard curve repeats in the future study only matters</span></span></span>
<span class="r-in"><span><span class="co"># to power calculation accuracy when the future study involves fish dropping out mid</span></span></span>
<span class="r-in"><span><span class="co"># study (due to sampling for example).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We will now plug in the past data into Surv_Simul() with the desired future</span></span></span>
<span class="r-in"><span><span class="co"># experimental design parameters!</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="Surv_Simul.html">Surv_Simul</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in Surv_Simul():</span> argument "haz_db" is missing, with no default</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Next, we input the simulated data to Surv_Power() to calculate power!</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In the above example, power is calculated for a global logrank test and _.</span></span></span>
<span class="r-in"><span><span class="co"># For example, based on model estimates, or to account for multiplicity of pairwise</span></span></span>
<span class="r-in"><span><span class="co"># comparison as shown below:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Additionally, we can investigate power across different experimental setups. What</span></span></span>
<span class="r-in"><span><span class="co"># if we want to know the effects of a weaker or stronger challenge to</span></span></span>
<span class="r-in"><span><span class="co"># power, for example. We can set this up using list_elements in Surv_Simul():</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># What if we want to know if the sample size we need to get 80% power in the weak</span></span></span>
<span class="r-in"><span><span class="co"># challenge scenario?</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The inter-tank variation ....Below are the results...</span></span></span>
<span class="r-in"><span><span class="co"># under two different challenge strength scenarios to show the complexities of the</span></span></span>
<span class="r-in"><span><span class="co"># influence of tank variation to power.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Additionally, showcase multiple analysis tools in case (for e.g. correction methods</span></span></span>
<span class="r-in"><span><span class="co"># and model fits..)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sean Andrew.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>


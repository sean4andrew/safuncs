<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Positive Rates for Contingency Table — Con_Simul_PR • safuncs</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Positive Rates for Contingency Table — Con_Simul_PR"><meta name="description" content="Computes statistical power and optionally false positive rates for tests applied to contingency tables based on simulations. Specify the simulation process using Con_Simul(), which serves as input. Positive rates are computed for the Chi-square test and optionally for Fisher's exact test and the Wald test applied to an ordinal regression model."><meta property="og:description" content="Computes statistical power and optionally false positive rates for tests applied to contingency tables based on simulations. Specify the simulation process using Con_Simul(), which serves as input. Positive rates are computed for the Chi-square test and optionally for Fisher's exact test and the Wald test applied to an ordinal regression model."><meta property="og:image" content="https://sean4andrew.github.io/safuncs/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">safuncs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/safuncs.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sean4andrew/safuncs/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate Positive Rates for Contingency Table</h1>
      <small class="dont-index">Source: <a href="https://github.com/sean4andrew/safuncs/blob/master/R/safuncs.R" class="external-link"><code>R/safuncs.R</code></a></small>
      <div class="d-none name"><code>Con_Simul_PR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes statistical power and optionally false positive rates for tests applied to contingency tables based on simulations. Specify the simulation process using <code><a href="Con_Simul.html">Con_Simul()</a></code>, which serves as input. Positive rates are computed for the Chi-square test and optionally for Fisher's exact test and the Wald test applied to an ordinal regression model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Con_Simul_PR</span><span class="op">(</span></span>
<span>  Con_Simul_Object <span class="op">=</span> <span class="fu"><a href="Con_Simul.html">Con_Simul</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  add_fisher_exact <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add_ord <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sample_sizes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_sim <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  FPR <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-con-simul-object">Con_Simul_Object<a class="anchor" aria-label="anchor" href="#arg-con-simul-object"></a></dt>
<dd><p>Output from <code><a href="Con_Simul.html">Con_Simul()</a></code> with the argument <code>verbose</code> set to TRUE.</p></dd>


<dt id="arg-add-fisher-exact">add_fisher_exact<a class="anchor" aria-label="anchor" href="#arg-add-fisher-exact"></a></dt>
<dd><p>Whether to compute positive rates for Fisher's Exact test. May add &gt;1 min of calculation time. Defaults to FALSE.</p></dd>


<dt id="arg-add-ord">add_ord<a class="anchor" aria-label="anchor" href="#arg-add-ord"></a></dt>
<dd><p>Whether to compute positive rates for Wald test on a fitted ordinal regression model. May add &gt;1 min of calculation time. Defaults to FALSE.</p></dd>


<dt id="arg-sample-sizes">sample_sizes<a class="anchor" aria-label="anchor" href="#arg-sample-sizes"></a></dt>
<dd><p>A vector of sample sizes over which false positive rates are to be calculated. A sample size is defined as the total number of counts in a contingency table. Defaults to total count received by <code>Con_Simul_Object</code>.</p></dd>


<dt id="arg-n-sim">n_sim<a class="anchor" aria-label="anchor" href="#arg-n-sim"></a></dt>
<dd><p>Number of contingency tables simulated for each positive rate calculation. Defaults to 1000.</p></dd>


<dt id="arg-fpr">FPR<a class="anchor" aria-label="anchor" href="#arg-fpr"></a></dt>
<dd><p>Whether to calculate false positive rate in addition to power. Defaults to TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a list containing:</p><table class="table table"><tr><td><code>pos_rate</code></td><td></td><td>A dataframe containing positive rates of various tests at specified sample sizes</td></tr><tr><td><code>eff_mat</code></td><td></td><td>The probability matrix used to calculate power</td></tr><tr><td><code>null_mat</code></td><td></td><td>The probability matrix used to calculate false positive rate</td></tr><tr><td><code>plot</code></td><td></td><td>A plot of positive rates of various tests at specified sample sizes</td></tr></table></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Power is defined as the percentage of tests yielding positive results (p-value &lt; 0.05) on a set of contingency tables simulated based on the data-generating process and probability matrix specified in <code><a href="Con_Simul.html">Con_Simul()</a></code>. The specified probability matrix should represent the parameters of the population where there is a desire to detect a significant effect in the sample. The simulated contingency tables then reflect the sample outcomes of the specified population parameter.</p>
<p>False Positive Rate is defined as the percentage of tests yielding positive results (p-value &lt; 0.05) on contingency tables simulated based on a probability matrix without treatment effect. The odd ratios between lesion scores for all treatment groups are assumed to be the same as that for control (first row in the probability matrix).</p>
<p>P-values for the Chi-square test are computed using <code><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">stats::chisq.test()</a></code> with default parameters. P-values for Fisher's exact test are computed using <code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">stats::fisher.test()</a></code> with <code>simulate.p.value</code> set to TRUE, alongside default parameters. P-values for ordinal regression are computed from <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">stats::anova()</a></code> applied to the output of <code><a href="https://rdrr.io/pkg/ordinal/man/clm.html" class="external-link">ordinal::clm()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://sean4andrew.github.io/safuncs/reference/Con_Simul_PR.html">Link</a> for executed <b>Examples</b> which includes any figure outputs.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Below I show how we can perform a simple power calculation using this tool.</span></span></span>
<span class="r-in"><span><span class="co">## Suppose I want to calculate power for Treatment B which halves the lesions in category 2 and 3.</span></span></span>
<span class="r-in"><span><span class="co">## I then specify the following probability matrix and feed it into Con_Simul():</span></span></span>
<span class="r-in"><span><span class="va">probs_mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">12</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim_tab</span> <span class="op">=</span> <span class="fu"><a href="Con_Simul.html">Con_Simul</a></span><span class="op">(</span><span class="va">probs_mat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Next, I feed the output into Con_Simul_PR():</span></span></span>
<span class="r-in"><span><span class="fu">Con_Simul_PR</span><span class="op">(</span><span class="va">sim_tab</span>, sample_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pos_rate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Total_Count Percent_of_Significant_Results Statistical_Test Class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           50                           56.8        Chisquare Power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          100                           87.5        Chisquare Power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          150                           95.7        Chisquare Power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10          50                            4.1        Chisquare   FPR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         100                            5.7        Chisquare   FPR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         150                            4.8        Chisquare   FPR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eff_mat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.1666667 0.16666667 0.16666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.3333333 0.08333333 0.08333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $null_mat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]      [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.1666667 0.1666667 0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.1666667 0.1666667 0.1666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $plot</span>
<span class="r-plt img"><img src="Con_Simul_PR-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## Results: Power is ~55, 86, and 97% for the Chi-square test using total counts of 50, 100, and 150, respectively.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The same power for Chi-square test can be calculated using Cohen's omega (w) method which is faster but has its own limitations;</span></span></span>
<span class="r-in"><span><span class="co">## e.g. assumes one data generating process for the contingency table (the no fixed marginals).</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/heliosdrm/pwr" class="external-link">pwr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.chisq.test.html" class="external-link">pwr.chisq.test</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/pwr/man/ES.w2.html" class="external-link">ES.w2</a></span><span class="op">(</span><span class="va">probs_mat</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">2</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span>, N <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Chi squared power calculation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               w = 0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               N = 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              df = 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       sig.level = 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           power = 0.8563144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOTE: N is the number of observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">## Results: Power is 85.6% for the Chi-square test at the total count of 100.</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sean Andrew.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>


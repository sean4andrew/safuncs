<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Analyze and Visualize Multivariate Data — MultiVar • safuncs</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyze and Visualize Multivariate Data — MultiVar"><meta name="description" content="Conducts PCA, LDA, and MANOVA. Outputs include tables of statistical results, PCA plots, and Boxplots of each dependent variable. Plots can be customized using pca_ and boxplots_ prefixed arguments. Supports one- or two-factor analyses. In two-factor analyses, additional plots may be created with facets and/or pooling of values across levels of a selected factor, chosen using the arguments factors_pool and factors_facet. By default, saves results in a Word document, but allows exports as .pptx, .png, and/or R objects for further edits. A tutorial on how to generate various outputs from MultiVar() is available under Examples."><meta property="og:description" content="Conducts PCA, LDA, and MANOVA. Outputs include tables of statistical results, PCA plots, and Boxplots of each dependent variable. Plots can be customized using pca_ and boxplots_ prefixed arguments. Supports one- or two-factor analyses. In two-factor analyses, additional plots may be created with facets and/or pooling of values across levels of a selected factor, chosen using the arguments factors_pool and factors_facet. By default, saves results in a Word document, but allows exports as .pptx, .png, and/or R objects for further edits. A tutorial on how to generate various outputs from MultiVar() is available under Examples."><meta property="og:image" content="https://sean4andrew.github.io/safuncs/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">safuncs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/safuncs.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sean4andrew/safuncs/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analyze and Visualize Multivariate Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/sean4andrew/safuncs/blob/master/R/safuncs.R" class="external-link"><code>R/safuncs.R</code></a></small>
      <div class="d-none name"><code>MultiVar.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Conducts PCA, LDA, and MANOVA. Outputs include tables of statistical results, PCA plots, and Boxplots of each dependent variable. Plots can be customized using <code>pca_</code> and <code>boxplots_</code> prefixed arguments. Supports one- or two-factor analyses. In two-factor analyses, additional plots may be created with facets and/or pooling of values across levels of a selected factor, chosen using the arguments <code>factors_pool</code> and <code>factors_facet</code>. By default, saves results in a Word document, but allows exports as .pptx, .png, and/or R objects for further edits. A tutorial on how to generate various outputs from <code>MultiVar()</code> is available under <b>Examples</b>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MultiVar</span><span class="op">(</span></span>
<span>  <span class="va">multivar_db</span>,</span>
<span>  <span class="va">values_cols</span>,</span>
<span>  <span class="va">factors_cols</span>,</span>
<span>  factors_pool <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col1"</span>, <span class="st">"col2"</span><span class="op">)</span>,</span>
<span>  factors_facet <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  pca_ellipse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"confidence"</span><span class="op">)</span>,</span>
<span>  pca_facet_scales <span class="op">=</span> <span class="st">"fixed"</span>,</span>
<span>  pca_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pca_shapes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pca_grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  missing_method <span class="op">=</span> <span class="st">"imputation"</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  boxplot_filled <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  boxplot_x_angle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  boxplot_x_wrap <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  boxplot_x_lab <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  boxplot_x_text <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  boxplot_legend_pos <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  boxplot_points <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  boxplot_outliers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  boxplot_letters <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  boxplot_var_sep <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  colours <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colours_theme <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_out_png <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot_out_pptx <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot_out_R <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-multivar-db">multivar_db<a class="anchor" aria-label="anchor" href="#arg-multivar-db"></a></dt>
<dd><p>A dataframe with two types of columns. The first holds numeric values of the multivariate outcome variables, with each column containing one variable. The second type holds categories (factor levels), with each column containing one factor. An example dataframe can be viewed by running <code>View(data(multivar_db_ex))</code> in the R console.</p></dd>


<dt id="arg-values-cols">values_cols<a class="anchor" aria-label="anchor" href="#arg-values-cols"></a></dt>
<dd><p>A numeric vector specifying the order number of columns containing the outcome variables.</p></dd>


<dt id="arg-factors-cols">factors_cols<a class="anchor" aria-label="anchor" href="#arg-factors-cols"></a></dt>
<dd><p>A numeric vector specifying the order number of columns containing the factors. Maximum of two numbers (i.e. factors).</p></dd>


<dt id="arg-factors-pool">factors_pool<a class="anchor" aria-label="anchor" href="#arg-factors-pool"></a></dt>
<dd><p>A character vector indicating the factors which levels are to be pooled across in additional plots. Choose any combination of "col1" and "col2" which refers to the first and second column in <code>factors_cols</code>. Defaults to c("col1", "col2"). For boxplots, plots with grouping by the chosen factor will also be generated.</p></dd>


<dt id="arg-factors-facet">factors_facet<a class="anchor" aria-label="anchor" href="#arg-factors-facet"></a></dt>
<dd><p>A character vector indicating the factors which levels are to be faceted across in additional plots. Choose any combination of "col1" and "col2" which refers to the first and second column in <code>factors_cols</code>. Defaults to "none" which creates no additional plots.</p></dd>


<dt id="arg-pca-ellipse">pca_ellipse<a class="anchor" aria-label="anchor" href="#arg-pca-ellipse"></a></dt>
<dd><p>A character vector representing the type of ellipses to draw in PCA plots. Generates a plot for every specified type. Choose any combination of "confidence", "distribution", "convexhull", and/or "none". "confidence" draws ellipses representing the 95 percent confidence interval about the center of multivariate normal data (principal component scores); drawn using <code><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_conf_ellipse.html" class="external-link">ggpubr::stat_conf_ellipse()</a></code>. "distribution" represents ellipses expected to cover 95 percent of all multivariate normal data; drawn using <code><a href="https://ggplot2.tidyverse.org/reference/stat_ellipse.html" class="external-link">ggplot2::stat_ellipse()</a></code> with argument <code>type = "norm"</code>. "convexhull" represents the smallest convex polygon enclosing all points; drawn using <code><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_chull.html" class="external-link">ggpubr::stat_chull()</a></code>. For plots without ellipses, include "none". Defaults to c("confidence").</p></dd>


<dt id="arg-pca-facet-scales">pca_facet_scales<a class="anchor" aria-label="anchor" href="#arg-pca-facet-scales"></a></dt>
<dd><p>A string indicating whether the x and y axes in pca plots should be held constant across facets or variable. Options are "fixed", "free", "free_x", and "free_y" as according to <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">ggplot2::facet_wrap()</a></code>. Defaults to "fixed".</p></dd>


<dt id="arg-pca-labels">pca_labels<a class="anchor" aria-label="anchor" href="#arg-pca-labels"></a></dt>
<dd><p>A character vector representing the labels to draw in PCA plots. Choose any combination of "ind" and/or "var". "ind" represents individual point labels by their row number. "var" represents variable loadings drawn as arrows; the arrow length and direction are calculated as in <code><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html" class="external-link">factoextra::fviz_pca_biplot()</a></code>. Defaults to NULL (no labels drawn).</p></dd>


<dt id="arg-pca-shapes">pca_shapes<a class="anchor" aria-label="anchor" href="#arg-pca-shapes"></a></dt>
<dd><p>TRUE/FALSE indicating whether to use different shapes for each factor level in PCA plots. Defaults to FALSE. Different shapes are not supported for plots with greater than 6 factor levels.</p></dd>


<dt id="arg-pca-grid">pca_grid<a class="anchor" aria-label="anchor" href="#arg-pca-grid"></a></dt>
<dd><p>Whether to plot grid lines in pca plots. Defaults to TRUE.</p></dd>


<dt id="arg-missing-method">missing_method<a class="anchor" aria-label="anchor" href="#arg-missing-method"></a></dt>
<dd><p>A string representing the method to address missing values in <code>values_cols</code>. Choose from "imputation" or "na_omit". "imputation" fills in missing values with values created (imputed) based on the correlation between variables essentially; accomplished using <code><a href="https://rdrr.io/pkg/missMDA/man/imputePCA.html" class="external-link">missMDA::imputePCA()</a></code> with the ncp parameter <code><a href="https://rdrr.io/pkg/missMDA/man/estim_ncpPCA.html" class="external-link">missMDA::estim_ncpPCA()</a></code>. "na_omit" removes entire rows of data when at least one NA value is present. This method may result in a significant loss of data. Defaults to "imputation". The choice of <code>missing_method</code> would affect PCA, LDA, and MANOVA results but likely only to a small degree with few missing values. Has no impact on boxplots and ANOVAs.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>Whether to scale variable values (such that SD = 1 for each variable) before PCA or LDA. A common procedure in the z-score normalization of values that commonly precede PCA. It is not recommended to set this to FALSE, unless justified. Defaults to TRUE.</p></dd>


<dt id="arg-center">center<a class="anchor" aria-label="anchor" href="#arg-center"></a></dt>
<dd><p>Whether to center variable values (such that mean = 0 for each variable) before PCA or LDA. A common procedure in the z-score normalization of values that commonly precede PCA. It is not recommended to set this to FALSE, unless justified. Defaults to TRUE.</p></dd>


<dt id="arg-boxplot-filled">boxplot_filled<a class="anchor" aria-label="anchor" href="#arg-boxplot-filled"></a></dt>
<dd><p>Whether to color the insides of boxplots and points (i.e. fill them). If FALSE, boxplots and points are hollow with colored borders using <code>colour</code> in <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">ggplot2::aes()</a></code>, instead of using <code>fill</code>. Defaults to TRUE.</p></dd>


<dt id="arg-boxplot-x-angle">boxplot_x_angle<a class="anchor" aria-label="anchor" href="#arg-boxplot-x-angle"></a></dt>
<dd><p>A number describing the degree of tilt in the x-axis labels of the boxplots. Defaults to NULL (horizontal labels).</p></dd>


<dt id="arg-boxplot-x-wrap">boxplot_x_wrap<a class="anchor" aria-label="anchor" href="#arg-boxplot-x-wrap"></a></dt>
<dd><p>The maximum number of characters on a single line that would be split if a space bar is available between them. Defaults to NULL (no text wrapping).</p></dd>


<dt id="arg-boxplot-x-lab">boxplot_x_lab<a class="anchor" aria-label="anchor" href="#arg-boxplot-x-lab"></a></dt>
<dd><p>Whether to include a title for the x-axis of the boxplots. Defaults to FALSE.</p></dd>


<dt id="arg-boxplot-x-text">boxplot_x_text<a class="anchor" aria-label="anchor" href="#arg-boxplot-x-text"></a></dt>
<dd><p>Whether to include the text for the x-axis of the boxplots. Defaults to TRUE.</p></dd>


<dt id="arg-boxplot-legend-pos">boxplot_legend_pos<a class="anchor" aria-label="anchor" href="#arg-boxplot-legend-pos"></a></dt>
<dd><p>A string representing the position of the legend for boxplot. Options are "none", "bottom", "top", "left", "right". Use "none" to remove legend. Defaults to "right".</p></dd>


<dt id="arg-boxplot-points">boxplot_points<a class="anchor" aria-label="anchor" href="#arg-boxplot-points"></a></dt>
<dd><p>Whether to include points in boxplots. Defaults to TRUE.</p></dd>


<dt id="arg-boxplot-outliers">boxplot_outliers<a class="anchor" aria-label="anchor" href="#arg-boxplot-outliers"></a></dt>
<dd><p>Whether to plot outliers in boxplots. Useful when points have been removed using <code>boxplot_points = FALSE</code>. Defaults to FALSE.</p></dd>


<dt id="arg-boxplot-letters">boxplot_letters<a class="anchor" aria-label="anchor" href="#arg-boxplot-letters"></a></dt>
<dd><p>Whether statistical classes, denoted by different letters, should be displayed in boxplots. Classes are determined from pairwise comparisons of the appropriate type. "Faceted" and "Grouped" plots uses the "Conditional" pairwise comparisons with classes summarized in the corresponding table; "Pooled" plots uses "Pooled" comparisons; plots with all factor level combinations in the x-axis <em>ticks</em> uses "Complete" comparisons. Defaults to TRUE.</p></dd>


<dt id="arg-boxplot-var-sep">boxplot_var_sep<a class="anchor" aria-label="anchor" href="#arg-boxplot-var-sep"></a></dt>
<dd><p>Whether to include boxplots made separately for every variable. Defaults to FALSE.</p></dd>


<dt id="arg-colours">colours<a class="anchor" aria-label="anchor" href="#arg-colours"></a></dt>
<dd><p>A named character vector specifying the colors to use for different factor levels. E.g. For a factor with levels "A", "B", and "C", the <code>colours</code> vector may look like <code>c('A' = "brown", B = 'blue', C = '#f8e723')</code>. Defaults to NULL (default ggplot2 colours).</p></dd>


<dt id="arg-colours-theme">colours_theme<a class="anchor" aria-label="anchor" href="#arg-colours-theme"></a></dt>
<dd><p>A string representing the color palette to use for plots. Options listed in <code><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">ggplot2::scale_colour_brewer()</a></code> <strong>Palettes</strong> section. Defaults to NULL.</p></dd>


<dt id="arg-plot-out-png">plot_out_png<a class="anchor" aria-label="anchor" href="#arg-plot-out-png"></a></dt>
<dd><p>Whether to save plots as .png in the working directory. Defaults to FALSE.</p></dd>


<dt id="arg-plot-out-pptx">plot_out_pptx<a class="anchor" aria-label="anchor" href="#arg-plot-out-pptx"></a></dt>
<dd><p>Whether to save plots as editable forms in .pptx in the working directory. Defaults to FALSE.</p></dd>


<dt id="arg-plot-out-r">plot_out_R<a class="anchor" aria-label="anchor" href="#arg-plot-out-r"></a></dt>
<dd><p>Whether to output plots as ggplot2 objects in a list in R. Defaults to TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a Word document containing at least the following types of results (in the given order):</p>
<p><strong>Multivariate Analyses:</strong></p>
<ol><li><p>PC plot(s) illustrating the separation (if any) of PC scores between groups</p></li>
<li><p>Correlation plot between individual variables and principal components</p></li>
<li><p>Correlation table summarizing pearson correlation coefficients between all pairs of variables and principal components</p></li>
<li><p>Contribution table summarizing contribution values of variables to principal components</p></li>
<li><p>Contribution table summarizing contribution values of variables to major linear discriminants (i.e. to the separation between groups)</p></li>
<li><p>MANOVA table summarizing statistical evidence for any effect of factor(s)</p></li>
</ol><p><strong>(Bonus) Univariate Analyses:</strong></p>
<ol><li><p>Boxplot(s) comparing values of individual variables across groups.</p></li>
<li><p>ANOVA results table (Two-Factor or One-Factor)</p></li>
<li><p>Pairwise comparisons table</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Several functions published on CRAN are used by <code>MultiVar()</code> for various types of statistical analyses:</p>
<dl><dt>PCA</dt>
<dd><p>Uses <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">stats::prcomp()</a></code>. Pre-PCA, outcome variables may be scaled or centered using <code>scale</code> and <code>center</code> arguments, respectively. Missing values may have been imputed using <code><a href="https://rdrr.io/pkg/missMDA/man/imputePCA.html" class="external-link">missMDA::imputePCA()</a></code> and ncp parameter <code>ncp = missMDA::estim_ncpPCA()$ncp</code>.</p></dd>

 <dt>LDA</dt>
<dd><p>Uses <code><a href="https://rdrr.io/pkg/MASS/man/lda.html" class="external-link">MASS::lda()</a></code>. Pre-LDA, values may be scaled, centered, and missing values imputed, with the same methods as described for PCA.</p></dd>

 <dt>MANOVA</dt>
<dd><p>Uses <code><a href="https://rdrr.io/r/stats/manova.html" class="external-link">stats::manova()</a></code> and subsequently <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">car::Anova()</a></code> with the argument <code>type = 3</code> - relevant for analyses with two or more factors. Missing values may have been imputed with the same method described for PCA. By default, <code><a href="https://rdrr.io/r/stats/manova.html" class="external-link">stats::manova()</a></code> omits all rows with missing values. To achieve this in <code>MultiVar()</code>, set <code>missing_method</code> argument to "na_omit".</p></dd>

 <dt>PERMANOVA</dt>
<dd><p>Output available upon request. Uses <code><a href="https://rdrr.io/pkg/RVAideMemoire/man/adonis.II.html" class="external-link">RVAideMemoire::adonis.II()</a></code> with the argument <code>method = "euclidean"</code>. Missing values may be imputed using the same method described for PCA. By default, <code><a href="https://rdrr.io/pkg/RVAideMemoire/man/adonis.II.html" class="external-link">RVAideMemoire::adonis.II()</a></code> omits all rows with missing values. To achieve this in <code>MultiVar()</code>, set <code>missing_method</code> argument to "na_omit".</p></dd>

 <dt>ANOVA</dt>
<dd><p>Uses <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">stats::anova()</a></code> and subsequently <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">car::Anova()</a></code> with the argument <code>type = 3</code> - relevant for analyses with two or more factors.</p></dd>

 <dt>Pairwise Comparisons</dt>
<dd><p>Uses <code><a href="https://arsilva87.github.io/biotools/reference/mvpaircomp.html" class="external-link">biotools::mvpaircomp()</a></code> and <code><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html" class="external-link">emmeans::emmeans()</a></code> for multivariate and univariate comparisons, both with <code>adjust = "BH"</code>. P-values were adjusted using the Benjamini Hochberg procedure to control for a false Discovery Rate of 5 percent.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://sean4andrew.github.io/safuncs/reference/MultiVar.html">Link</a> for web documentation.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Below is a brief tutorial to help you get various outputs from MultiVar()!</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Lets start simple, with the aim of creating a report for a one-factor dataset</span></span></span>
<span class="r-in"><span><span class="co"># called iris:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Data structure:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iris</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          5.1         3.5          1.4         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          4.9         3.0          1.4         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          4.7         3.2          1.3         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          4.6         3.1          1.5         0.2  setosa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          5.0         3.6          1.4         0.2  setosa</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can see that columns #1 to #4 contain dependent variables, while column #5 holds</span></span></span>
<span class="r-in"><span><span class="co"># the factor. Simply feed this information into Multivar()!</span></span></span>
<span class="r-in"><span><span class="fu">MultiVar</span><span class="op">(</span>multivar_db <span class="op">=</span> <span class="va">iris</span>,</span></span>
<span class="r-in"><span>         values_cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span></span>
<span class="r-in"><span>         factors_cols <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>         plot_out_R <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># hide R output for now</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A report is now saved in your working directory, check it out! You can locate your</span></span></span>
<span class="r-in"><span><span class="co"># working directory using:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/home/runner/work/safuncs/safuncs/docs/reference"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Suppose you wanted a more equipped PCA plot. We can customize our plots using a</span></span></span>
<span class="r-in"><span><span class="co"># set of arguments indicated with the proper prefix; 'pca_' for PCA plots and</span></span></span>
<span class="r-in"><span><span class="co"># 'boxplots_' for Boxplots:</span></span></span>
<span class="r-in"><span><span class="fu">MultiVar</span><span class="op">(</span>multivar_db <span class="op">=</span> <span class="va">iris</span>,</span></span>
<span class="r-in"><span>         values_cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span></span>
<span class="r-in"><span>         factors_cols <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>         pca_ellipse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"confidence"</span>, <span class="st">"distribution"</span>, <span class="st">"convexhull"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         pca_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"var"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         plot_out_R <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">pca</span><span class="op">$</span><span class="va">distribution</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $none</span>
<span class="r-plt img"><img src="MultiVar-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If you want to customize the plot beyond the capabilities of MultiVar(), save them</span></span></span>
<span class="r-in"><span><span class="co"># as editable forms in .pptx using the argument plot_out_ppt or manipulate them further</span></span></span>
<span class="r-in"><span><span class="co"># in R:</span></span></span>
<span class="r-in"><span><span class="fu">MultiVar</span><span class="op">(</span>multivar_db <span class="op">=</span> <span class="va">iris</span>,</span></span>
<span class="r-in"><span>         values_cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span></span>
<span class="r-in"><span>         factors_cols <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>         boxplot_x_angle <span class="op">=</span> <span class="fl">45</span>,</span></span>
<span class="r-in"><span>         plot_out_R <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">box</span><span class="op">$</span><span class="va">none</span><span class="op">$</span><span class="va">facetvariables</span> <span class="op">+</span></span></span>
<span class="r-in"><span> <span class="fu">ggthemes</span><span class="fu">::</span><span class="fu"><a href="http://jrnold.github.io/ggthemes/reference/theme_tufte.html" class="external-link">theme_tufte</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Use the thufte theme</span></span></span>
<span class="r-plt img"><img src="MultiVar-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## TWO FACTOR CASES</span></span></span>
<span class="r-in"><span><span class="co"># Real data often have two factors, and MultiVar() produces plots tailored to that.</span></span></span>
<span class="r-in"><span><span class="co"># At minimum, MultiVar() produces plots with the interaction between two factors as</span></span></span>
<span class="r-in"><span><span class="co"># x-axis labels or legend labels. This can lead to a lot of levels in the axis or</span></span></span>
<span class="r-in"><span><span class="co"># legends which look unsightly. Run the code below to see how this looks like! Below</span></span></span>
<span class="r-in"><span><span class="co"># I am using an example fish mucus dataset with one real factor (Treatment) and one</span></span></span>
<span class="r-in"><span><span class="co"># fake (Fruits).</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">multivar_db_ex</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">multivar_db_ex</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Treatment Severity Stage Muscle.degen Muscle.regen Bacteria Re.epithelization</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         A        3     1            1            0        0                 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         A        4     0            2            0        2                 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         A        4     4            1            0        0                 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         A        4     4            2            1        0                 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         A        3     3            1            0        0                 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Mucous.Cell.Grades Fruits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                  0 Orange</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                  0 Orange</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                  1 Orange</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                  3 Orange</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                  1  Apple</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">MultiVar</span><span class="op">(</span>multivar_db <span class="op">=</span> <span class="va">multivar_db_ex</span>,</span></span>
<span class="r-in"><span>         values_cols <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>         factors_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         factors_pool <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>         factors_facet <span class="op">=</span> <span class="st">"none"</span>,</span></span>
<span class="r-in"><span>         plot_out_R <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check out the report in your working directory!</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Additional plots can be created with facets or pooling of values across levels of a</span></span></span>
<span class="r-in"><span><span class="co"># factor. Below we explore the default parameters which consists of 'factors_pool =</span></span></span>
<span class="r-in"><span><span class="co"># c('col1', 'col2')' and its output:</span></span></span>
<span class="r-in"><span><span class="fu">MultiVar</span><span class="op">(</span>multivar_db <span class="op">=</span> <span class="va">multivar_db_ex</span>,</span></span>
<span class="r-in"><span>         values_cols <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>         factors_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         factors_pool <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col1"</span>, <span class="st">"col2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         plot_out_R <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">pca</span><span class="op">$</span><span class="va">confidence</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pooled1"</span>, <span class="st">"pooled2"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pooled1</span>
<span class="r-plt img"><img src="MultiVar-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pooled2</span>
<span class="r-plt img"><img src="MultiVar-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The "col1" specification instructs MultiVar() to create a plot with pooling across</span></span></span>
<span class="r-in"><span><span class="co"># levels of the first factor specified in 'values_cols', while "col2" refers to the</span></span></span>
<span class="r-in"><span><span class="co"># second factor.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plots with facets can also be created. Below, we facet against levels of the second</span></span></span>
<span class="r-in"><span><span class="co"># factor (Fruits) which is considered as a nuisance factor in this case:</span></span></span>
<span class="r-in"><span><span class="fu">MultiVar</span><span class="op">(</span>multivar_db <span class="op">=</span> <span class="va">multivar_db_ex</span>,</span></span>
<span class="r-in"><span>         values_cols <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>         factors_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         factors_pool <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col1"</span>, <span class="st">"col2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         factors_facet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         plot_out_R <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">pca</span><span class="op">$</span><span class="va">confidence</span><span class="op">[</span><span class="st">"facet2"</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $facet2</span>
<span class="r-plt img"><img src="MultiVar-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check your word document output and you will see that it contains facets and pooling</span></span></span>
<span class="r-in"><span><span class="co"># for both PCA and boxplots. End of tutorial. Hope it helps!</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sean Andrew.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>


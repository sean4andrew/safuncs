<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate Survival Data — Surv_Simul • safuncs</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate Survival Data — Surv_Simul"><meta name="description" content="Simulates survival data based on a set of user-specified experimental parameters and a reference hazard curve (e.g. hazard curve from the control group). Able to simulate data with inter-cluster (e.g. tank) variation which is added based on the framework of the mixed cox proportional hazards model (coxme::coxme). Able to simulate right censored data (e.g. sampled fish) using sampling_specs argument. Able to simulate treatment- and tank- specific fish numbers. Optionally produces a plot illustrating the characteristics of the simulated data and that of the population / truth from which the data (sample) is simulated."><meta property="og:description" content="Simulates survival data based on a set of user-specified experimental parameters and a reference hazard curve (e.g. hazard curve from the control group). Able to simulate data with inter-cluster (e.g. tank) variation which is added based on the framework of the mixed cox proportional hazards model (coxme::coxme). Able to simulate right censored data (e.g. sampled fish) using sampling_specs argument. Able to simulate treatment- and tank- specific fish numbers. Optionally produces a plot illustrating the characteristics of the simulated data and that of the population / truth from which the data (sample) is simulated."><meta property="og:image" content="https://sean4andrew.github.io/safuncs/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">safuncs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/safuncs.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sean4andrew/safuncs/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Simulate Survival Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/sean4andrew/safuncs/blob/master/R/safuncs.R" class="external-link"><code>R/safuncs.R</code></a></small>
      <div class="d-none name"><code>Surv_Simul.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulates survival data based on a set of user-specified experimental parameters and a reference hazard curve (e.g. hazard curve from the control group). Able to simulate data with inter-cluster (e.g. tank) variation which is added based on the framework of the mixed cox proportional hazards model (<code><a href="https://rdrr.io/pkg/coxme/man/coxme.html" class="external-link">coxme::coxme</a></code>). Able to simulate right censored data (e.g. sampled fish) using <code>sampling_specs</code> argument. Able to simulate treatment- and tank- specific fish numbers. Optionally produces a plot illustrating the characteristics of the simulated data and that of the population / truth from which the data (sample) is simulated.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Surv_Simul</span><span class="op">(</span></span>
<span>  <span class="va">haz_db</span>,</span>
<span>  fish_num_per_tank <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  tank_num_per_trt <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  treatments_hr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  logHR_sd_intertank <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sampling_specs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exp_design <span class="op">=</span> <span class="st">"between-tank"</span>,</span>
<span>  n_sim <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  prog_show <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_out <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pop_out <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  theme <span class="op">=</span> <span class="st">"ggplot2"</span>,</span>
<span>  plot_save <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-haz-db">haz_db<a class="anchor" aria-label="anchor" href="#arg-haz-db"></a></dt>
<dd><p>A dataframe representing the reference hazard curve; can be generated from <code><a href="https://rdrr.io/pkg/bshazard/man/bshazard.html" class="external-link">bshazard::bshazard()</a></code> or <code><a href="Surv_Plots.html">Surv_Plots()</a></code>.</p></dd>


<dt id="arg-fish-num-per-tank">fish_num_per_tank<a class="anchor" aria-label="anchor" href="#arg-fish-num-per-tank"></a></dt>
<dd><p>The number of fish to simulate per tank, defaults to 100. If this differs by treatment, specify a vector of numbers ordered according to <code>treatments_hr</code>. When there is a need to compare experiments with different setups (fish numbers), specify the different setups as elements in a list (see <b>Examples</b>). This is useful for comparing power between experimental setups (for calculations see <code><a href="Surv_Power.html">Surv_Power()</a></code>). Only 1 input parameter in <code>Surv_Simul()</code> can be specified as a list.</p></dd>


<dt id="arg-tank-num-per-trt">tank_num_per_trt<a class="anchor" aria-label="anchor" href="#arg-tank-num-per-trt"></a></dt>
<dd><p>The number of tanks to simulate per treatment group, defaults to 4. If this differs by treatment, specify a vector of numbers ordered according to <code>treatments_hr</code>. Input can be specified as elements in a list, with each element representing different experimental setups as described for <code>fish_num_per_tank</code>.</p></dd>


<dt id="arg-treatments-hr">treatments_hr<a class="anchor" aria-label="anchor" href="#arg-treatments-hr"></a></dt>
<dd><p>A vector representing the hazard ratios of the treatment groups starting with the reference/control (HR = 1), defaults to <code>c(1, 1, 1, 1)</code>. Length of the vector represents the number of treatment groups. Input can be specified as elements in a list, with each element representing different experimental setups as described for <code>fish_num_per_tank</code>.</p></dd>


<dt id="arg-loghr-sd-intertank">logHR_sd_intertank<a class="anchor" aria-label="anchor" href="#arg-loghr-sd-intertank"></a></dt>
<dd><p>The standard deviation of inter-tank variation (which contributes to overall data variation) in the log-HR scale according to the <code>coxme</code> framework. Defaults to 0 (no tank effect) which has been and quite oftenly, the estimate for injected Trojan fish data. For reference 0.1 reflects a low tank effect, while 0.35 is fairly high but can and has occurred in some immersion challenged fish datasets. Input can be specified as elements in a list, with each element representing different experimental setups as described for <code>fish_num_per_tank</code>.</p></dd>


<dt id="arg-sampling-specs">sampling_specs<a class="anchor" aria-label="anchor" href="#arg-sampling-specs"></a></dt>
<dd><p>A dataframe containing at least 2 columns; "Amount" representing the number of right censored data (e.g. sampled fish) per tank; "TTE" representing the time the sampling occurred; optionally a "Trt.ID" column to account for different sampling conditions per tank per treatment. Trt.IDs must start with "Control", then capitalized letters (see <b>Examples</b>). Defaults to NULL (no sampling). Input can be specified as elements in a list, with each element representing different experimental setups as described for <code>fish_num_per_tank</code>.</p></dd>


<dt id="arg-exp-design">exp_design<a class="anchor" aria-label="anchor" href="#arg-exp-design"></a></dt>
<dd><p>A string specifying the type of experimental design. Can be "between-tank" which indicates each tank has a unique treatment hence the treatment effect occurs "between-tanks". Or, "within-tank" where each tank contains fish exposed to various treatments.</p></dd>


<dt id="arg-n-sim">n_sim<a class="anchor" aria-label="anchor" href="#arg-n-sim"></a></dt>
<dd><p>Number of survival dataset to simulate. Defaults to 1. For serious power calculations, an n_sim &lt; 2000 is likely the most you'll ever need for precise results.</p></dd>


<dt id="arg-prog-show">prog_show<a class="anchor" aria-label="anchor" href="#arg-prog-show"></a></dt>
<dd><p>Whether to display the progress of <code>Surv_Simul()</code> by printing the number of simulations completed. Defaults to TRUE.</p></dd>


<dt id="arg-plot-out">plot_out<a class="anchor" aria-label="anchor" href="#arg-plot-out"></a></dt>
<dd><p>Whether to output the information plot (further details in <b>Value</b>). Defaults to TRUE.</p></dd>


<dt id="arg-pop-out">pop_out<a class="anchor" aria-label="anchor" href="#arg-pop-out"></a></dt>
<dd><p>Whether to output a dataframe containing the survival probability values for the population. Defaults to TRUE.</p></dd>


<dt id="arg-theme">theme<a class="anchor" aria-label="anchor" href="#arg-theme"></a></dt>
<dd><p>A string specifying the graphics theme for the plots. Theme "ggplot2" and "prism" currently available. Defaults to "ggplot2".</p></dd>


<dt id="arg-plot-save">plot_save<a class="anchor" aria-label="anchor" href="#arg-plot-save"></a></dt>
<dd><p>Whether to save plot as .tiff in the working directory. Defaults to TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a list that, at minimum, contains the simulated survival dataframe (<code>surv_simul_db</code>) which has at least 5 columns: TTE (Time to Event), Status (0 / 1), Trt.ID, Tank.ID, and n_sim which represents the simulation number for the data subsets. Additionally, can contain a column named "list_element_num" which represents the list element number when an input argument to <code>Surv_Simul()</code> is specified as a list.</p>
<p>If <code>plot_out = TRUE</code>, the list includes Kaplan-Meier survival plots. The left faceted plot represents the survival curves for the simulated sample set, while the right represents that for the population/truth. Numbers at the end of survival curves represent the end survival rate for that treatment. If the number of simulated sample sets exceed 1, multiple survival curves are drawn with each representing a sample set. In such cases, a statement is also provided informing of the probability to detect the effect of Treatment using a global logrank test from <code><a href="https://rdrr.io/pkg/survival/man/survdiff.html" class="external-link">survival::survdiff()</a></code>, i.e. the power or false positive rate.</p>
<p>If <code>pop_out = TRUE</code>, the list includes a dataframe (<code>surv_pop_db</code>) representing the survival rates (probabilities) for the population / truth from which the sample is simulated. The dataframe contains three columns: Trt.ID, surv_prob which represents the survival probabilities, and TTE.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Simulations are based on uniform-probability draws (<em>U</em> ~ (0, 1)) from a set of events which can be expressed as a function of time using the cumulative density function of failures (<em>F(t)</em>, i.e. cumulative mort. curve). Because the cumulative mort curve (<em>F(t)</em>) can be expressed in terms of the cumulative hazard function <em>H(t)</em>, the relationship between <em>H(t)</em> and <em>U</em> draws is known (for derivation and equation, see <a href="https://epub.ub.uni-muenchen.de/1716/1/paper_338.pdf" class="external-link">Bender et al. (2003)</a>. Because <em>H(t)</em> is related (as the integral) to the hazard function <em>h(t)</em>, and since <em>h(t)</em> is related to effects (e.g. treatment or tank) based on the cox proportional hazards model, such effects can now be incorporated into the simulation process as they interact with <em>U</em>. The simulation process is as follows:</p>
<ol><li><p><code>Surv_Simul()</code> takes a random sample from <em>U</em> (e.g. 0.7).</p></li>
<li><p>U is then transformed into <em>H</em> as they are related as discussed. The equation relating <em>U</em>, <em>H</em>, and treatment effects is shown below (obtain from <a href="https://epub.ub.uni-muenchen.de/1716/1/paper_338.pdf" class="external-link">Bender et al. 2003</a> which also shows the derivation of the equation):</p>
<p><em>H = -log(U) ⋅ exp(-log(β))</em>; <em>β</em> representing treatment or tank effects.</p></li>
<li><p>The function <em>H(t)</em> inverse (known from the supplied reference hazard curve) is applied to <em>H</em> to obtain <em>t</em> (time to event) which represents the survival data.</p></li>
<li><p>Data with <em>t</em> beyond the last follow-up period represent survivors (Status set to 0), and below it, represents mortalities (Status set to 1).</p></li>
</ol><p>To verify the correct "randomness" is produced in the simulated survival data, given that adding "randomness" is the whole point of simulations (to me), 5 different validation checks have been performed (documented in a pdf to be uploaded to github). Those checks showed that the HR estimated by fitting two curves sampled from the same population, converges to a mean of 1 (as should be) over many simulations, and across simulations the HR varies as expected (SD of simulated HRs = SE of HR as supposed by the cox model). Those checks also showed that the p-value obtained by applying log-rank test to null (no-effect) simulated datasets, has a distribution that is uniform (as should be), with a false positive rate of 0.05 given the alpha used was 0.05 (as should be). Additionally, power calculated from the simulations equal to the power calculated from an <a href="https://homepage.univie.ac.at/robin.ristl/samplesize.php?test=logrank" class="external-link">online calculator</a>. Last, the checks showed that the variations in a simulated survival curve is similar to that observed in curves simulated using a different, more limited, method (bootstraping / re-sampling with replacement).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://sean4andrew.github.io/safuncs/reference/Surv_Simul.html">Link</a> for executed <b>Examples</b> which includes any figure outputs.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Starting from an example mortality database, we first generate the complete survivor</span></span></span>
<span class="r-in"><span><span class="co"># data using Surv_Gen()</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mort_db_ex</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">surv_dat</span> <span class="op">=</span> <span class="fu"><a href="Surv_Gen.html">Surv_Gen</a></span><span class="op">(</span>mort_db <span class="op">=</span> <span class="va">mort_db_ex</span>,</span></span>
<span class="r-in"><span>                    starting_fish_count <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                    last_tte <span class="op">=</span> <span class="fl">54</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Your total number of tanks is: 12"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Your total number of treatment groups is: 4"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Your total number of fish in the output data is: 1200"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Filter for the control group ("A") to get a reference hazard curve for simulations</span></span></span>
<span class="r-in"><span><span class="va">surv_dat_A</span> <span class="op">=</span> <span class="va">surv_dat</span><span class="op">[</span><span class="va">surv_dat</span><span class="op">$</span><span class="va">Trt.ID</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate the hazard curve of the control group and get the associated hazard</span></span></span>
<span class="r-in"><span><span class="co"># dataframe using bshazard::bshazard() or safuncs::Surv_Plots()$Hazard_DB</span></span></span>
<span class="r-in"><span><span class="va">ref_haz_route_bshazard</span> <span class="op">=</span> <span class="fu">bshazard</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bshazard/man/bshazard.html" class="external-link">bshazard</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">surv_dat_A</span>,</span></span>
<span class="r-in"><span>                                            <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">TTE</span>, <span class="va">Status</span><span class="op">)</span> <span class="op">~</span> <span class="va">Tank.ID</span>,</span></span>
<span class="r-in"><span>                                            nbin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">surv_dat_A</span><span class="op">$</span><span class="va">TTE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                            verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOTE: entry.status has been set to 0 for all.</span>
<span class="r-in"><span><span class="va">ref_haz_route_bshazard</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ref_haz_route_bshazard</span><span class="op">)</span><span class="op">$</span><span class="va">HazardEstimates</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ref_haz_route_safuncs</span> <span class="op">=</span> <span class="fu">safuncs</span><span class="fu">::</span><span class="fu"><a href="Surv_Plots.html">Surv_Plots</a></span><span class="op">(</span>surv_db <span class="op">=</span> <span class="va">surv_dat_A</span>,</span></span>
<span class="r-in"><span>                                            data_out <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">Hazard_DB</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate! Sampled 10 fish per tank at 45 DPC, but otherwise default conditions.</span></span></span>
<span class="r-in"><span><span class="fu">Surv_Simul</span><span class="op">(</span>haz_db <span class="op">=</span> <span class="va">ref_haz_route_safuncs</span>,</span></span>
<span class="r-in"><span>           treatments_hr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.8</span>, <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           sampling_specs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Amount <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                                       TTE <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">surv_plots</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated 1 of 1 sample sets</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Time elapsed: 00:00:00 (hh:mm:ss)"</span>
<span class="r-plt img"><img src="Surv_Simul-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Further, results of simulating multiple times are shown to better understand the</span></span></span>
<span class="r-in"><span><span class="co"># chance that future samples accurately capture the truth/population. Specify n_sim!</span></span></span>
<span class="r-in"><span><span class="fu">Surv_Simul</span><span class="op">(</span>haz_db <span class="op">=</span> <span class="va">ref_haz_route_safuncs</span>,</span></span>
<span class="r-in"><span>           treatments_hr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.8</span>, <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           sampling_specs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Amount <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                                       TTE <span class="op">=</span> <span class="fl">45</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           prog_show <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#hide simulation progress notes for cleaner output</span></span></span>
<span class="r-in"><span>           n_sim <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">$</span><span class="va">surv_plots</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Time elapsed: 00:00:00 (hh:mm:ss)"</span>
<span class="r-plt img"><img src="Surv_Simul-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Surv_Simul() can handle even more complicated experimental designs. Below, I use</span></span></span>
<span class="r-in"><span><span class="co"># different (across treatments) fish numbers per tank, tank numbers, and sampling</span></span></span>
<span class="r-in"><span><span class="co"># designs.</span></span></span>
<span class="r-in"><span><span class="fu">Surv_Simul</span><span class="op">(</span>haz_db <span class="op">=</span> <span class="va">ref_haz_route_safuncs</span>,</span></span>
<span class="r-in"><span>           fish_num_per_tank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span>, <span class="co">#for Ctrl., Trt.A, B, respectively</span></span></span>
<span class="r-in"><span>           tank_num_per_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,       <span class="co">#Ctrl., A, B</span></span></span>
<span class="r-in"><span>           treatments_hr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.8</span>, <span class="fl">0.5</span><span class="op">)</span>,      <span class="co">#Ctrl., A, B</span></span></span>
<span class="r-in"><span>           sampling_specs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>TTE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                       Amount <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">5</span><span class="op">)</span>, <span class="co">#0 sample for Ctrl.</span></span></span>
<span class="r-in"><span>                                       Trt.ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           prog_show <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>           n_sim <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">$</span><span class="va">surv_plots</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Time elapsed: 00:00:00 (hh:mm:ss)"</span>
<span class="r-plt img"><img src="Surv_Simul-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># What if we want to compare power of the global log-rank test (shown in the plot)</span></span></span>
<span class="r-in"><span><span class="co"># across different experimental setups with different fish numbers per treatment?</span></span></span>
<span class="r-in"><span><span class="co"># Below, I setup a Surv_Simul() to answer this question.</span></span></span>
<span class="r-in"><span><span class="fu">Surv_Simul</span><span class="op">(</span>haz_db <span class="op">=</span> <span class="va">haz_db_ex</span>,</span></span>
<span class="r-in"><span>           fish_num_per_tank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           tank_num_per_trt <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>           treatments_hr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           prog_show <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>           n_sim <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">$</span><span class="va">surv_plots</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Time elapsed: 00:00:01 (hh:mm:ss)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="Surv_Simul-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="Surv_Simul-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot[[1]] and [[2]] shows the results from fish_num_per_tank = 30 and 100,</span></span></span>
<span class="r-in"><span><span class="co"># respectively. Additionally, the simulated data output (...$surv_simul_db) can be</span></span></span>
<span class="r-in"><span><span class="co"># supplied to safuncs::Surv_Power() (under development) to calculate power for</span></span></span>
<span class="r-in"><span><span class="co"># various tests (e.g. log-rank global, pairwise with(out) correction) or tests based</span></span></span>
<span class="r-in"><span><span class="co"># on statistical models with various forms (e.g. with(out) tank-variation)).</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sean Andrew.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>


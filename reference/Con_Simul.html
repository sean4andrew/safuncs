<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate Contingency Table — Con_Simul • safuncs</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate Contingency Table — Con_Simul"><meta name="description" content="Simulate a contingency table with fish counts distributed across n lesion categories and n treatment groups. Probability values for generating counts in each cell (i.e. each factor level combination) can be assigned using the probs argument. This function is designed for use in power and/or false positive rate calculations; for details, see Con_Simul_PR()."><meta property="og:description" content="Simulate a contingency table with fish counts distributed across n lesion categories and n treatment groups. Probability values for generating counts in each cell (i.e. each factor level combination) can be assigned using the probs argument. This function is designed for use in power and/or false positive rate calculations; for details, see Con_Simul_PR()."><meta property="og:image" content="https://sean4andrew.github.io/safuncs/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">safuncs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/safuncs.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sean4andrew/safuncs/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Simulate Contingency Table</h1>
      <small class="dont-index">Source: <a href="https://github.com/sean4andrew/safuncs/blob/master/R/safuncs.R" class="external-link"><code>R/safuncs.R</code></a></small>
      <div class="d-none name"><code>Con_Simul.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulate a contingency table with fish counts distributed across <em>n</em> lesion categories and <em>n</em> treatment groups. Probability values for generating counts in each cell (i.e. each factor level combination) can be assigned using the <code>probs</code> argument. This function is designed for use in power and/or false positive rate calculations; for details, see <code><a href="Con_Simul_PR.html">Con_Simul_PR()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Con_Simul</span><span class="op">(</span></span>
<span>  probs <span class="op">=</span> <span class="st">"equal"</span>,</span>
<span>  total_count <span class="op">=</span> <span class="fl">750</span>,</span>
<span>  n_lesion <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_Trt. <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  margin_fixed_Trt. <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-probs">probs<a class="anchor" aria-label="anchor" href="#arg-probs"></a></dt>
<dd><p>Matrix of probability values created using <code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix()</a></code>. Each row in the matrix should represent a treatment group and each column a lesion category. All probability values in the matrix should sum to 1. Default = equal probability across all cells.</p></dd>


<dt id="arg-total-count">total_count<a class="anchor" aria-label="anchor" href="#arg-total-count"></a></dt>
<dd><p>Total number of counts in the contingency table. Defaults to 750.</p></dd>


<dt id="arg-n-lesion">n_lesion<a class="anchor" aria-label="anchor" href="#arg-n-lesion"></a></dt>
<dd><p>Number of lesion categories. Ignored if <code>probs</code> specified. Defaults to 3.</p></dd>


<dt id="arg-n-trt-">n_Trt.<a class="anchor" aria-label="anchor" href="#arg-n-trt-"></a></dt>
<dd><p>Number of treatment groups. Ignored if <code>probs</code> specified. Defaults to 5.</p></dd>


<dt id="arg-margin-fixed-trt-">margin_fixed_Trt.<a class="anchor" aria-label="anchor" href="#arg-margin-fixed-trt-"></a></dt>
<dd><p>Whether margins are fixed per treatment group (i.e. fixed number of fish per treatment). Default = FALSE. See <b>Details</b> for further information on marginals.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Whether to print the parameters and probability matrix used. Default = TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a list containing:</p><table class="table table"><tr><td><code>sim_tab</code></td><td></td><td>The simulated contingency table containing counts across different treatment groups (rows) and lesion categories (columns)</td></tr><tr><td><code>params</code></td><td></td><td>The simulation parameters as a vector</td></tr><tr><td><code>probs</code></td><td></td><td>The probability matrix used for simulation</td></tr></table></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Counts are simulated from a multinomial distribution using <code><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">rmultinom()</a></code>. Counts may be assumed to have a fixed total in the marginals (e.g. per treatment group) or no fixed total in row or column marginals.</p>
<p>For further discussion into the types of marginals in contingency tables, refer to: <a href="https://www.uvm.edu/~statdhtx/StatPages/More_Stuff/Chi-square/Contingency-Tables.pdf" class="external-link">here</a> and the comments on <b>Arguments</b>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://sean4andrew.github.io/safuncs/reference/Con_Simul.html">Link</a> for executed <b>Examples</b> which includes any figure outputs.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulate table with uniform probabilities across cells</span></span></span>
<span class="r-in"><span><span class="fu">Con_Simul</span><span class="op">(</span>total_count <span class="op">=</span> <span class="fl">750</span>, n_lesion <span class="op">=</span> <span class="fl">3</span>, n_Trt. <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sim_tab</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Lesion_Category</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trt.  1  2  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    A 43 59 46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    B 48 60 49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    C 45 49 51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    D 44 50 45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    E 48 55 58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $params</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       total_count          n_lesion            n_Trt. margin_fixed_Trt. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               750                 3                 5                 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $probs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.06666667 0.06666667 0.06666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.06666667 0.06666667 0.06666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.06666667 0.06666667 0.06666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.06666667 0.06666667 0.06666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.06666667 0.06666667 0.06666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate table with specified probabilities across cells</span></span></span>
<span class="r-in"><span><span class="fu">Con_Simul</span><span class="op">(</span>probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">3</span><span class="op">/</span><span class="fl">12</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sim_tab</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Lesion_Category</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trt.   1   2   3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    A 127 117 112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    B 174 154  66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $params</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       total_count          n_lesion            n_Trt. margin_fixed_Trt. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               750                 3                 2                 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $probs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.1666667 0.1666667 0.16666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.2500000 0.1666667 0.08333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sean Andrew.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

